import e from"https://luiscastro193.github.io/PRNG/PRNG.js";import"https://cdn.jsdelivr.net/npm/chance@1.1.12/chance.min.js";import{unzip as a,zip as t}from"https://luiscastro193.github.io/zip-string/zip-string.js";let n=["Avi\xf3n","Banco","Barco pirata","Base militar","Batalla campal","Carnaval","Casino","Circo","Colegio","Comisar\xeda de polic\xeda","Crucero","Discoteca","Embajada","Estaci\xf3n espacial","Fiesta de empresa","Gasolinera","Hospital","Hotel","Parque de atracciones","Playa","Restaurante","Rodaje de una pel\xedcula","Sierra Nevada","Spa","Submarino","Supermercado","Teatro","Tren de pasajeros","Universidad","Zool\xf3gico"],o=document.querySelector("dialog"),i=document.querySelector("textarea"),[l,c,r,s]=o.querySelectorAll("button"),u=n;if(location.hash){let e=await a(location.hash.slice(1)).catch(console.error);e?u=e.split("\n"):history.replaceState(null,""," ")}window.onhashchange=()=>location.reload(),c.onclick=()=>o.close(),r.onclick=()=>{i.value=""},s.onclick=()=>{i.value=n.join("\n")},l.onclick=async()=>{if(i.value=i.value.trim(),i.reportValidity()){let e=[...new Set(i.value.split(/\s+^\s*/m))].sort().join("\n");e!=u.join("\n")&&(e==n.join("\n")?(history.pushState(null,""," "),window.onhashchange()):location.hash=await t(e)),o.close()}},document.getElementById("edit").onclick=()=>{i.value=u.join("\n"),o.showModal()},document.getElementById("share").onclick=()=>{navigator.share?navigator.share({url:location.href}):navigator.clipboard.writeText(location.href).then(()=>alert("Enlace copiado al portapapeles")).catch(()=>alert("Copia el enlace para compartir la lista de localizaciones"))},document.getElementById("qr").onclick=async()=>{window.open("https://luiscastro193.github.io/qr-generator/#"+await t(location.href))};let m=document.getElementById("currentLocation"),d=document.querySelector("form"),p=document.getElementById("seed"),h=document.getElementById("locationList");async function g(a){a.preventDefault();let t=new Chance(await e(p.value.toLowerCase()));t.integer({min:1,max:d.numPlayers.valueAsNumber})==d.player.valueAsNumber?m.innerHTML="Eres el esp\xeda":m.innerHTML=t.pickone(u)}async function v(){let a=p.value?new Chance(await e(p.value.toLowerCase())):chance;p.value=a.word({syllables:2}),d.oninput()}for(let e of(chance=new Chance(Math.random),d.oninput=function(){m.innerHTML=""},d.onsubmit=g,p.nextElementSibling.onclick=v,document.querySelectorAll("input")))e.addEventListener("focus",()=>e.select());h.append(...chance.shuffle(u).map(function(e){let a=document.createElement("span");return a.textContent=e,a})),p.value=new Date().toLocaleDateString("es-ES"),location.hash&&(p.value+=u.join(),v()),document.fonts.ready.then(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{for(let e of h.children)e.style.cssText+=`grid-column: span ${e.offsetWidth+15}`;h.classList.replace("smart-list","smart-list-computed")})})});